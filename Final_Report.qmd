---
title: "Final Report"
author: "Sian Bareket, Cindy Sun, Sarah Susnea, Yuhan Wang" 
format: 
  html:
    self-contained: true
---

```{r, include = F}
# loading packages
library(readxl)
library(tidyverse)
library(stringr)
library(ggplot2)
library(readr)
library(lubridate)
library(timevis)


# reading in the data
data_raw <- read_excel("Voter Registry.xls")
data_clean <- data_raw
```

```{r, include = FALSE}
# cleaning some of the columns: 

data_clean$`FIRST NAME` <- toupper(data_clean$`FIRST NAME`)
data_clean$PARTY <- str_to_title(data_clean$PARTY)
data_clean$POB <- str_to_title(data_clean$POB)
data_clean$`STREET NAME` <- str_to_title(data_clean$`STREET NAME`)
data_clean$SEX <- str_to_title(data_clean$SEX)

# coercing to date 
data_clean$DOB <- as.Date(data_clean$DOB)
data_clean$`VOTER REG DATE` <- as.Date(data_clean$`VOTER REG DATE`)

# saving cleaned df as csv
write.csv(data_clean, file = "Voter_Registry_clean.csv", row.names = FALSE)
```

```{r, include = FALSE}
# reading in the cleaned csv: 
data <- read_csv("Voter_Registry_clean.csv")

# preparing data for visualization by extracting the year
data$year_vote <- year(data$`VOTER REG DATE`)

# created manipulated df for visualization
data_vis1 <- data |>
  filter(year_vote >= 1990) |>
  filter(is.na(`STREET NAME`))
```

```{r, echo = FALSE}
# create first bar plot 
ggplot(data = data_vis1, aes(x = as.factor(year_vote), fill = PARTY), color = "black") +
  geom_bar() +
  scale_fill_manual(values = c("royalblue", "limegreen", "yellow2", "red3", "snow3"))+
  labs(title = "Voter Registration for People With No Address",
       x = "Year",
       y = "Number of People Registered",
       fill = "Party") +
  theme_minimal()
```

```{r, include = FALSE}
# get year from date of birth: 
data$year_birth <- year(data$DOB)

# create df for second visualization
data_vis2 <- data |>
  mutate(years_old_vote = year_vote - year_birth) |>
  filter(years_old_vote <= 17)
```

```{r, echo = FALSE}
ggplot(data = data_vis2, aes(x = as.factor(years_old_vote))) + 
  geom_bar() + 
  labs(title = "Voter Registration Age",
       x = "Age",
       y = "Count") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5) +
  theme_minimal()
```


![](network_diagram.png)



```{r, echo = FALSE}
timeline_data <- data.frame(
  id      = 1:21,
  content = c("Investigation into Swiss VonRyker Institute", 
              "<b>VonRyker closes<b>", 
              "<b>First BSE case discovered at Mabton Farms<b>", 
              "<b>Phone calls between City Hall & Swiss number</b>", 
              "<b>Mayor Rex Luthor announced Boynton Labs development</b>", 
              "Breaking ground on Boynton Labs",
              "Voter registry fraud",
              "John Torch announces mayoral run",
              "Gov chose Boynton Labs to test for BSE",
              "US FDA investigation into Boynton Labs",
              "<b>Scandal! Torch seen with Boynton lab's Laurel Sulafate</b>",
              "US gov fighting initial BSE outbreak",
              "USDA killed 119 out of 129 Mabton & Alderwood cows",
              "FDA cancels investigation into Boynton labs",
              "Gov invests money in developing mad cow disease test",
              "Boynton labs breakthrough in BSE treatment",
              "<b>First phone call between City Hall & Swiss number</b>",
              "DNA evidence proves BSE positive cow is from Canada",
              "Scientists at Boynton labs produced prion protein",
              "<b>Washen Foundation</b> invests $1 mil in Boynton labs",
              "<b>Mayor Rex Luthor</b> announced Boynton Labs development"),
  start   = c("2001-08-30", 
              "2001-09-15", 
              "2001-12-01", 
              "2002-01-06", 
              "2002-02-02", 
              "2002-05-05",
              "2002-09-14",
              "2003-07-12",
              "2003-09-13",
              "2004-5-16",
              "2004-05-30",
              "2001-12-01",
              "2002-01-19",
              "2004-06-19",
              "2002-02-19",
              "2004-03-02",
              "2002-01-06",
              "2002-02-10",
              "2004-01-20",
              "2002-02-02",
              "2002-02-02"),
  end     = c("2001-09-15", 
              NA, 
              NA, 
              "2002-01-26", 
              NA, 
              NA,
              "2003-07-31",
              NA,
              NA,
              "2004-06-19",
              NA,
              "2002-02-20",
              NA,
              NA,
              NA,
              NA,
              NA,
              NA,
              NA,
              NA,
              NA),
  group = c("labs", 
            "labs", 
            "bse", 
            "pol", 
            "labs", 
            "labs", 
            "pol", 
            "pol", 
            "bse", 
            "labs", 
            "pol", 
            "bse", 
            "bse", 
            "labs", 
            "bse", 
            "labs",
            "pol", 
            "bse",
            "labs",
            "pol",
            "pol"),
  type = c("range", "point", "point", "range", "point", "point", "range", "point", "point", "range", "point", "range", "point", "point", "point", "point", "point","point", "point", "point","point")
)

groups <- data.frame(id = c("pol", "bse", "labs"),
                     content = c("Political", "Mad Cow Disease", "Lab News"))

timevis(timeline_data, groups = groups, options = list(editable = FALSE, selectable = FALSE, zoomable = TRUE, stack = TRUE, verticalscroll = TRUE))
```



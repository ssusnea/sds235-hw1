---
title: "Visualizations"
format: html
---

```{r}
library(ggplot2)
library(dplyr)
library(readr)
data <- read_csv("Voter_Registry_clean.csv")
```

```{r}
ggplot(data = data, aes(x = PARTY)) + geom_bar()
```

# take out the year of voter reg date in order to create visualization
```{r}
library(lubridate)
data$year_vote <- year(data$`VOTER REG DATE`)
```

# create the database for the first visualization
```{r}
data_vis1 <- data |>
  filter(year_vote >= 1990) |>
  filter(is.na(`STREET NAME`))
```

# create a barplot
```{r}
ggplot(data = data_vis1, aes(x = as.factor(year_vote), fill = PARTY), color = "black") +
  geom_bar() +
  scale_fill_manual(values = c("royalblue", "limegreen", "yellow2", "red3", "snow3"))+
  labs(title = "What happened in 2002 and 2003 with people registered to vote?",
       x = "Years",
       y = "Number of people volting",
       fill = "Party") +
  theme_minimal()
```

# try to prove that registration dates did not seem to correspond to the dates of birth listed

```{r}
data$year_birth <- year(data$DOB)
```

```{r}
plot_year1 <- ggplot(data = data, aes(x = as.factor(year_birth))) + geom_bar()
```

```{r}
plot_year2 <- ggplot(data = data, aes(x = as.factor(year_vote))) + geom_bar()
```

```{r}
library(patchwork)
combined_year <- plot_year1 + plot_year2
combined_year
```
This is not working!

# Another way

```{r}
data_vis2 <- data |>
  mutate(years_old_vote = year_vote - year_birth) |>
  filter(years_old_vote <= 17) |>
  mutate(status = case_when(years_old_vote < 0 ~ "Impossible",
                            years_old_vote >= 0 & years_old_vote <= 17 ~ "Illegal",
                            TRUE ~ "Legal"))
```

```{r}
ggplot(data = data_vis2, aes(x = as.factor(years_old_vote), fill = status)) + 
  geom_bar() + 
  labs(title = "At what age are people registered to vote?",
       x = "Age when people are registered to vote",
       y = "Number of people",
       fill = "Voting Status") +
  geom_text(stat = 'count', aes(label = after_stat(count)), vjust = -0.5) +
  theme_minimal() +
  scale_fill_manual(values = c("red3", "snow4"))
```

